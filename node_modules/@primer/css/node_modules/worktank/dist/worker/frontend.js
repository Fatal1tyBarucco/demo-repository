/* IMPORT */
import WorkerShim from 'webworker-shim';
import WorkerBackend from './backend_compiled.js';
/* MAIN */
class WorkerFrontend {
    /* CONSTRUCTOR */
    constructor(methods, name, listener) {
        const code = `data:text/javascript;charset=utf-8,${encodeURIComponent(WorkerBackend.replace('/*! METHODS_PLACEHOLDER !*/', `\n\n\n${methods}`))}`;
        this.worker = new WorkerShim(code, { name, type: 'module' });
        this.listen(listener);
    }
    /* API */
    listen(listener) {
        this.worker.addEventListener('message', event => listener(event.data));
    }
    send(message) {
        this.worker.postMessage(message);
    }
    terminate() {
        this.worker.terminate();
    }
}
/* EXPORT */
export default WorkerFrontend;
